<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Weekly Cleanup & Setup</title>
  </head>
  <body>
    <h1>Weekly Cleanup & Setup</h1>
    <style>
      #drop-area {
        border: 2px dashed #ccc;
        border-radius: 10px;
        width: 100%;
        max-width: 400px;
        padding: 20px;
        text-align: center;
        margin-bottom: 20px;
        cursor: pointer;
      }
      #drop-area.highlight {
        border-color: #666;
        background-color: #f8f8f8;
      }
      #fileElem {
        display: none;
      }
    </style>
    <form method="post" enctype="multipart/form-data">
      <div id="drop-area">
        <p>Drag & drop your Excel/CSV file here, or click to select</p>
        <input type="file" id="fileElem" name="workbook" accept=".xlsx,.csv" required>
      </div>
      <label>Week #: <input type="number" name="week" min="1" required></label><br><br>
      <button type="submit">Process</button>
    </form>
    <script>
      const dropArea = document.getElementById('drop-area');
      const fileInput = document.getElementById('fileElem');
      const prompt = dropArea.querySelector('p');

      ;['dragenter','dragover','dragleave','drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, e => { e.preventDefault(); e.stopPropagation(); }, false);
      });
      ;['dragenter','dragover'].forEach(eventName => {
        dropArea.addEventListener(eventName, () => dropArea.classList.add('highlight'), false);
      });
      ;['dragleave','drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, () => dropArea.classList.remove('highlight'), false);
      });
      dropArea.addEventListener('drop', e => {
        const dt = e.dataTransfer;
        const files = dt.files;
        if (files.length) {
          fileInput.files = files;
          prompt.textContent = files[0].name;
        }
      }, false);
      dropArea.addEventListener('click', () => fileInput.click());
      fileInput.addEventListener('change', () => {
        if (fileInput.files.length) prompt.textContent = fileInput.files[0].name;
      });
    </script>
  </body>
</html>
